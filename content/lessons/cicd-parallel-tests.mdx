---
title: Parallel Testing
chapterSlug: cicd-rails-testing
duration: 8
order: 2
---

## Matrix Strategy

Run tests in parallel across configurations:

```yaml
jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        ruby: ['3.1', '3.2', '3.3']
        database: ['postgres', 'mysql']
    
    steps:
      - uses: ruby/setup-ruby@v1
        with:
          ruby-version: ${{ matrix.ruby }}
```

## Parallel Test Execution

Split tests across multiple runners:

```yaml
jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        ci_node_total: [4]
        ci_node_index: [0, 1, 2, 3]
    
    steps:
      - name: Run tests
        env:
          CI_NODE_TOTAL: ${{ matrix.ci_node_total }}
          CI_NODE_INDEX: ${{ matrix.ci_node_index }}
        run: |
          bundle exec rspec $(
            circleci tests glob "spec/**/*_spec.rb" |
            circleci tests split --split-by=timings
          )
```

## Using parallel_tests Gem

```ruby
# Gemfile
gem 'parallel_tests', group: :test
```

```yaml
- name: Run parallel tests
  run: bundle exec parallel_rspec spec/
```

## Fail Fast

```yaml
strategy:
  fail-fast: true  # Stop all on first failure
  matrix:
    ruby: ['3.1', '3.2']
```

